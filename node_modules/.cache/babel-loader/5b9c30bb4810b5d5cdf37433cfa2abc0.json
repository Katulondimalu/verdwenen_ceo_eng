{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar UnsupportedOperationException_1 = require(\"../UnsupportedOperationException\");\n\nvar CharacterSetECI_1 = require(\"../common/CharacterSetECI\");\n/**\n * Responsible for en/decoding strings.\n */\n\n\nvar StringEncoding =\n/** @class */\nfunction () {\n  function StringEncoding() {}\n  /**\n   * Decodes some Uint8Array to a string format.\n   */\n\n\n  StringEncoding.decode = function (bytes, encoding) {\n    var encodingName = this.encodingName(encoding);\n\n    if (this.customDecoder) {\n      return this.customDecoder(bytes, encodingName);\n    } // Increases browser support.\n\n\n    if (typeof TextDecoder === 'undefined' || this.shouldDecodeOnFallback(encodingName)) {\n      return this.decodeFallback(bytes, encodingName);\n    }\n\n    return new TextDecoder(encodingName).decode(bytes);\n  };\n  /**\n   * Checks if the decoding method should use the fallback for decoding\n   * once Node TextDecoder doesn't support all encoding formats.\n   *\n   * @param encodingName\n   */\n\n\n  StringEncoding.shouldDecodeOnFallback = function (encodingName) {\n    return !StringEncoding.isBrowser() && encodingName === 'ISO-8859-1';\n  };\n  /**\n   * Encodes some string into a Uint8Array.\n   */\n\n\n  StringEncoding.encode = function (s, encoding) {\n    var encodingName = this.encodingName(encoding);\n\n    if (this.customEncoder) {\n      return this.customEncoder(s, encodingName);\n    } // Increases browser support.\n\n\n    if (typeof TextEncoder === 'undefined') {\n      return this.encodeFallback(s);\n    } // TextEncoder only encodes to UTF8 by default as specified by encoding.spec.whatwg.org\n\n\n    return new TextEncoder().encode(s);\n  };\n\n  StringEncoding.isBrowser = function () {\n    return typeof window !== 'undefined' && {}.toString.call(window) === '[object Window]';\n  };\n  /**\n   * Returns the string value from some encoding character set.\n   */\n\n\n  StringEncoding.encodingName = function (encoding) {\n    return typeof encoding === 'string' ? encoding : encoding.getName();\n  };\n  /**\n   * Returns character set from some encoding character set.\n   */\n\n\n  StringEncoding.encodingCharacterSet = function (encoding) {\n    if (encoding instanceof CharacterSetECI_1.default) {\n      return encoding;\n    }\n\n    return CharacterSetECI_1.default.getCharacterSetECIByName(encoding);\n  };\n  /**\n   * Runs a fallback for the native decoding funcion.\n   */\n\n\n  StringEncoding.decodeFallback = function (bytes, encoding) {\n    var characterSet = this.encodingCharacterSet(encoding);\n\n    if (StringEncoding.isDecodeFallbackSupported(characterSet)) {\n      var s = '';\n\n      for (var i = 0, length_1 = bytes.length; i < length_1; i++) {\n        var h = bytes[i].toString(16);\n\n        if (h.length < 2) {\n          h = '0' + h;\n        }\n\n        s += '%' + h;\n      }\n\n      return decodeURIComponent(s);\n    }\n\n    if (characterSet.equals(CharacterSetECI_1.default.UnicodeBigUnmarked)) {\n      return String.fromCharCode.apply(null, new Uint16Array(bytes.buffer));\n    }\n\n    throw new UnsupportedOperationException_1.default(\"Encoding \" + this.encodingName(encoding) + \" not supported by fallback.\");\n  };\n\n  StringEncoding.isDecodeFallbackSupported = function (characterSet) {\n    return characterSet.equals(CharacterSetECI_1.default.UTF8) || characterSet.equals(CharacterSetECI_1.default.ISO8859_1) || characterSet.equals(CharacterSetECI_1.default.ASCII);\n  };\n  /**\n   * Runs a fallback for the native encoding funcion.\n   *\n   * @see https://stackoverflow.com/a/17192845/4367683\n   */\n\n\n  StringEncoding.encodeFallback = function (s) {\n    var encodedURIstring = btoa(unescape(encodeURIComponent(s)));\n    var charList = encodedURIstring.split('');\n    var uintArray = [];\n\n    for (var i = 0; i < charList.length; i++) {\n      uintArray.push(charList[i].charCodeAt(0));\n    }\n\n    return new Uint8Array(uintArray);\n  };\n\n  return StringEncoding;\n}();\n\nexports.default = StringEncoding;","map":{"version":3,"sources":["../../../src/core/util/StringEncoding.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar UnsupportedOperationException_1 = require(\"../UnsupportedOperationException\");\nvar CharacterSetECI_1 = require(\"../common/CharacterSetECI\");\n/**\n * Responsible for en/decoding strings.\n */\nvar StringEncoding = /** @class */ (function () {\n    function StringEncoding() {\n    }\n    /**\n     * Decodes some Uint8Array to a string format.\n     */\n    StringEncoding.decode = function (bytes, encoding) {\n        var encodingName = this.encodingName(encoding);\n        if (this.customDecoder) {\n            return this.customDecoder(bytes, encodingName);\n        }\n        // Increases browser support.\n        if (typeof TextDecoder === 'undefined' || this.shouldDecodeOnFallback(encodingName)) {\n            return this.decodeFallback(bytes, encodingName);\n        }\n        return new TextDecoder(encodingName).decode(bytes);\n    };\n    /**\n     * Checks if the decoding method should use the fallback for decoding\n     * once Node TextDecoder doesn't support all encoding formats.\n     *\n     * @param encodingName\n     */\n    StringEncoding.shouldDecodeOnFallback = function (encodingName) {\n        return !StringEncoding.isBrowser() && encodingName === 'ISO-8859-1';\n    };\n    /**\n     * Encodes some string into a Uint8Array.\n     */\n    StringEncoding.encode = function (s, encoding) {\n        var encodingName = this.encodingName(encoding);\n        if (this.customEncoder) {\n            return this.customEncoder(s, encodingName);\n        }\n        // Increases browser support.\n        if (typeof TextEncoder === 'undefined') {\n            return this.encodeFallback(s);\n        }\n        // TextEncoder only encodes to UTF8 by default as specified by encoding.spec.whatwg.org\n        return new TextEncoder().encode(s);\n    };\n    StringEncoding.isBrowser = function () {\n        return (typeof window !== 'undefined' && {}.toString.call(window) === '[object Window]');\n    };\n    /**\n     * Returns the string value from some encoding character set.\n     */\n    StringEncoding.encodingName = function (encoding) {\n        return typeof encoding === 'string'\n            ? encoding\n            : encoding.getName();\n    };\n    /**\n     * Returns character set from some encoding character set.\n     */\n    StringEncoding.encodingCharacterSet = function (encoding) {\n        if (encoding instanceof CharacterSetECI_1.default) {\n            return encoding;\n        }\n        return CharacterSetECI_1.default.getCharacterSetECIByName(encoding);\n    };\n    /**\n     * Runs a fallback for the native decoding funcion.\n     */\n    StringEncoding.decodeFallback = function (bytes, encoding) {\n        var characterSet = this.encodingCharacterSet(encoding);\n        if (StringEncoding.isDecodeFallbackSupported(characterSet)) {\n            var s = '';\n            for (var i = 0, length_1 = bytes.length; i < length_1; i++) {\n                var h = bytes[i].toString(16);\n                if (h.length < 2) {\n                    h = '0' + h;\n                }\n                s += '%' + h;\n            }\n            return decodeURIComponent(s);\n        }\n        if (characterSet.equals(CharacterSetECI_1.default.UnicodeBigUnmarked)) {\n            return String.fromCharCode.apply(null, new Uint16Array(bytes.buffer));\n        }\n        throw new UnsupportedOperationException_1.default(\"Encoding \" + this.encodingName(encoding) + \" not supported by fallback.\");\n    };\n    StringEncoding.isDecodeFallbackSupported = function (characterSet) {\n        return characterSet.equals(CharacterSetECI_1.default.UTF8) ||\n            characterSet.equals(CharacterSetECI_1.default.ISO8859_1) ||\n            characterSet.equals(CharacterSetECI_1.default.ASCII);\n    };\n    /**\n     * Runs a fallback for the native encoding funcion.\n     *\n     * @see https://stackoverflow.com/a/17192845/4367683\n     */\n    StringEncoding.encodeFallback = function (s) {\n        var encodedURIstring = btoa(unescape(encodeURIComponent(s)));\n        var charList = encodedURIstring.split('');\n        var uintArray = [];\n        for (var i = 0; i < charList.length; i++) {\n            uintArray.push(charList[i].charCodeAt(0));\n        }\n        return new Uint8Array(uintArray);\n    };\n    return StringEncoding;\n}());\nexports.default = StringEncoding;\n//# sourceMappingURL=StringEncoding.js.map"]},"metadata":{},"sourceType":"script"}